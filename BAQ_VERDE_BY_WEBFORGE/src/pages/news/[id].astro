---
import Layout from "../../layouts/Layout.astro";
import { api } from "../../lib/api.js";
import "../../styles/global.css";

export async function getStaticPaths() {
    return [];
}

const { id } = Astro.params;
let noticia = null;

try {
    const response = await api(`/news/${id}`, {
        method: "GET",
        headers: { "Content-Type": "application/json" },
    });

    noticia = response;
} catch (error) {
    console.error("Error fetching news detail:", error);
}
---

<Layout title={noticia?.title || "Detalle de Noticia"}>
    {
        noticia ? (
            <section class="news-detail">
                <div class="news-hero">
                    <img
                        src={`${import.meta.env.PUBLIC_URL_SERVER}${noticia.img_url}`}
                        alt={noticia.title}
                        class="news-image"
                    />
                </div>

                <div class="news-content">
                    <h1 class="news-title">{noticia.title}</h1>
                    <div class="title-underline" />

                    <p class="news-description">{noticia.description}</p>

                    <div class="news-text">
                        <p>{noticia.content}</p>
                    </div>

                    <p class="news-date">ðŸ“… {noticia.date}</p>

                    <a href="/news" class="back-link">
                        â¬… Volver a noticias
                    </a>
                </div>
            </section>
        ) : (
            <p style="text-align:center; padding:2rem; color:#666;">No se encontrÃ³ la noticia.</p>
        )
    }
</Layout>

<style>
    .news-detail {
        max-width: 1100px;
        margin: 0 auto;
        padding: var(--spacing-xl) var(--spacing-md);
    }

    .news-hero {
        width: 100%;
        height: 60vh;
        overflow: hidden;
        border-radius: var(--border-radius-lg);
        margin-bottom: var(--spacing-xl);
        box-shadow: var(--shadow-md);
    }

    .news-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .news-content {
        text-align: left;
    }

    .news-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--bv-azul-oscuro);
        margin-bottom: var(--spacing-sm);
    }

    .title-underline {
        width: 100px;
        height: 4px;
        background-color: var(--bv-verde-primario);
        margin-bottom: var(--spacing-xl);
        border-radius: var(--border-radius-sm);
    }

    .news-description {
        font-size: 1.25rem;
        font-weight: 500;
        color: var(--bv-gris);
        margin-bottom: var(--spacing-lg);
    }

    .news-text {
        font-size: 1.1rem;
        line-height: 1.8;
        color: var(--bv-gris);
        margin-bottom: var(--spacing-xl);
        text-align: justify;
    }

    .news-date {
        font-size: 0.95rem;
        color: var(--bv-gris-claro);
        margin-bottom: var(--spacing-lg);
    }

    .back-link {
        display: inline-block;
        text-decoration: none;
        background-color: var(--bv-verde-primario);
        color: var(--bv-blanco);
        padding: var(--spacing-sm) var(--spacing-md);
        border-radius: var(--border-radius-sm);
        font-weight: 600;
        transition: background 0.3s;
    }
    .back-link:hover {
        background-color: var(--bv-verde-primario-dark);
    }
</style>
